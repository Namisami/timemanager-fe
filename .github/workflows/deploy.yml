
name: Deploy

on:
  push:
    branches: ["main"]
  pull_request:
    branches: ["main"]
    types: [closed]

jobs:
  prepare:
    runs-on: self-hosted
    steps:
        - name: Checkout code
          uses: actions/checkout@v4
          with:
            ref: main
        - name: Update to last changes
          run:
            sudo git fetch origin
            sudo git pull origin main
  build:
    runs-on: self-hosted
    needs: [prepare]
    steps:
        - name: Install dependencies
          run: npm install

        - name: Build React Web
          run: npm run build

  deploy:
    runs-on: self-hosted
    needs: [build]
    steps:
        - name: Reload nginx
          run: sudo systemctl reload nginx
